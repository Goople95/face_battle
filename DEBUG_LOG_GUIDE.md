# 调试日志指南

## 日志输出说明

运行游戏时，在调试控制台中可以看到详细的AI决策过程。

### 1. AI模式切换日志
```
🔄 AI模式切换: Gemini AI
当前个性: 教授
```

### 2. 决策阶段日志

#### 使用Gemini AI时：
```
🌐 使用Gemini AI进行决策 (个性: 教授)
ℹ️ API密钥已配置: AIzaSyC9yK...

========== Gemini AI 决策开始 ==========
当前回合状态: 玩家叫牌=3个4

--- 发送给AI的Prompt ---
[显示完整的prompt内容，包括：]
- AI的个性描述
- 游戏规则
- 当前骰子状态
- 对手的叫牌
- 要求的回答格式
--- Prompt结束 ---

正在调用Gemini API...
API请求参数:
- 温度: 0.3 (教授) / 0.6 (挑衅者) / 0.9 (赌徒)
- 最大tokens: 200
- API端点: https://generativelanguage.googleapis.com/...
API响应状态码: 200

--- AI原始响应 ---
[显示Gemini返回的完整文本]
--- 响应结束 ---

开始解析AI决策响应...
提取的JSON: {"action": "challenge", "probability": 0.25, "reasoning": "..."}
解析成功:
- action: challenge
- probability: 0.25
- reasoning: 根据计算，你的3个4成功概率仅25.0%

解析后的决策: 质疑
计算概率: 25.0%
理由: 根据计算，你的3个4成功概率仅25.0%
========== Gemini AI 决策结束 ==========

✅ Gemini AI决策成功
```

#### 使用本地算法时：
```
💻 使用本地算法进行决策 (个性: 教授)
ℹ️ 提示: API密钥未配置
✅ 本地AI决策完成
```

### 3. 叫牌阶段日志

```
========== Gemini AI 叫牌开始 ==========
上一个叫牌: 2个3
AI手中的骰子: [1, 3, 3, 4, 5]

--- 发送给AI的Prompt ---
[显示叫牌prompt]
--- Prompt结束 ---

正在调用Gemini API...

--- AI原始响应 ---
[显示响应内容]
--- 响应结束 ---

开始解析AI叫牌响应...
提取的JSON: {"quantity": 3, "value": 3, "bluffing": false, "reasoning": "..."}
解析成功:
- quantity: 3
- value: 3
- bluffing: false
- reasoning: 我有两个3，加上一个万能1

叫牌合法性检查: 通过
解析后的叫牌: 3个3
========== Gemini AI 叫牌结束 ==========

✅ Gemini AI叫牌成功: 3个3
```

### 4. 错误处理日志

当API调用失败时：
```
❌ Gemini API调用失败: [错误信息]
API错误响应: [错误详情]
降级到本地算法
使用降级逻辑
```

### 5. 日志符号说明

- 🌐 - 使用云端AI
- 💻 - 使用本地算法
- ℹ️ - 信息提示
- ✅ - 成功
- ❌ - 失败
- ⚠️ - 警告
- 🔄 - 切换

## 如何查看日志

### Flutter运行时
```bash
flutter run
```
日志会实时显示在终端中。

### VS Code调试
1. 按F5启动调试
2. 在"调试控制台"面板查看日志

### Android Studio
1. 点击运行按钮
2. 在"Run"或"Logcat"面板查看日志

## 常见问题

### 1. 看不到日志输出
- 确保使用`flutter run`而不是`flutter run --release`
- 检查调试控制台是否被过滤

### 2. API调用总是失败
- 检查API密钥是否正确配置
- 确认网络连接正常
- 查看错误响应了解具体原因

### 3. 日志太多看不过来
- 可以搜索关键字如"Gemini AI"、"决策"、"叫牌"
- 关注"=========="分隔符之间的内容
- 重点看"✅"和"❌"标记的结果